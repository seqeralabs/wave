---
title: Wave application configuration
plugins: [sectionize]
---

Set Wave configuration values using environment variables or in the [`config.yml`](https://github.com/seqeralabs/wave/blob/master/config.yml) configuration file.

### config.yml configuration

Declare YAML configuration values in [`config.yml`](https://github.com/seqeralabs/wave/blob/master/config.yml)
```
wave:
    mail:
        from: "wave-app@seqera.io"
```

YAML configuration keys on this page are listed in "dot" notation, i.e., the mail from value in the snippet above is represented as `wave.mail.from` in the tables that follow.
Environment variables for various attributes has been listed in third column, either you can provide those attributes values in config.yml or using corresponding environment variable.

## General configuration

General configuration options such as Wave application name, port, whether to allow anonymous access (without tower token), Wave and Seqera platform url.

`micronaut.application.name` *(optional)*
: Sets the name of the Wave application (default: `wave-app`).

`micronaut.server.port` *(optional)*
: Sets the port used by the Wave server (default:  `8080`).

`wave.allowAnonymous` *(required)*
: Specifies whether anonymous access to the Wave server is permitted. (default: `false`)
: Modify this option based on your security requirements.

`wave.server.url` *(optional)*
: Sets the URL for the Wave server.
: Can be set using `${WAVE_SERVER_URL}` environment variable.

`wave.tokens.cache.duration` *(optional)*
: Sets the duration for cached tokens generated by Wave (default: `1h`).

`tower.endpoint.url` *(optional)*
: Sets the URL pointing to the Seqera platform API service (default: [`https://api.cloud.seqera.io`](https://api.cloud.seqera.io)).

`logger.levels.io.seqera` *(optional)*
: Sets the [logger level](https://logging.apache.org/log4j/2.x/manual/customloglevels.html)  for the `io.seqera`package (default: `TRACE`).
: Adjust levels based on logging requirements.


## Container registry configuration

The generic format for the attributes is `wave.registries.<registry_name>.username` and `wave.registries.<registry_name>.password`.
You need to specify all the repositories you will use in the respective Wave installation.
Below are the standard format for known registries, but you can change registry name `(azurecr.io)` to specific one like `seqeralabs.azurecr.io `.

:::note
Container registry credentials can be defined in [`config.yml`](https://github.com/seqeralabs/wave/blob/master/config.yml) too.
These configurations are important for the Wave authentication to the repositories used to push or pull artifacts.
:::

`wave.registries.default` *(optional)*
: Sets the default Docker registry for Wave (default: `docker.io`).

`wave.registries.docker.io.username` *(optional)*
: Sets the Docker Hub username for authentication.
: Can be set using the `${DOCKER_USER}` environment variable.

`wave.registries.docker.io.password` *(optional)*
: Sets the Docker Hub password or PAT (Personal Access Token) for authentication.
: Can be set using the `${DOCKER_PAT}` environment variable.

`wave.registries.quay.io.username` *(optional)*
: Sets the Quay.io username for authentication.
: Can be set using the `${QUAY_USER}` environment variable.

`wave.registries.quay.io.password` *(optional)*
: Sets the Quay.io password or PAT for authentication.
: Can be set using the `${QUAY_PAT}` environment variable.

`wave.registries.<AWS ECR Repo name>.username` *(optional)*
: Sets the AWS ECR (Elastic Container Registry) username for authentication.
: For example, `195996028523.dkr.ecr.eu-west-1.amazonaws.com`.
: Can be set using the `${AWS_ACCESS_KEY_ID}` environment variable.

`wave.registries.<AWS ECR Repo name>.password` *(optional)*
: Sets the AWS ECR password for authentication.
: For example: `195996028523.dkr.ecr.eu-west-1.amazonaws.com`.
: Can be set using `${AWS_SECRET_ACCESS_KEY}` environment variable.

## HTTP client configuration

`wave.httpclient.connectTimeout` *(optional)*
: Sets the  connection timeout for the HTTP client (defult: `20s`).

`wave.httpclient.retry.delay` *(optional)*
: Sets the delay for HTTP client retries (defualt: `1s`).

`wave.httpclient.retry.attempts` *(optional)*
: Sets the number of HTTP client retry attempts (defualt: `5`).

`wave.httpclient.retry.maxDelay` *(optional)*
: Sets the  maximum delay for HTTP client retries.

`wave.httpclient.retry.jitter` *(optional)*
: Sets the jitter for HTTP client retries (default: `0.25`).

`wave.httpclient.retry.multiplier` *(optional)*
: Sets the multiplier for HTTP client retries. (default: `1.0`).

`micronaut.http.services.stream-client.read-timeout` *(optional)*
: Sets the read timeout for the streaming HTTP client (default: `30s`).

`micronaut.http.services.stream-client.read-idle-timeout` *(optional)*
: Sets the read idle timeout for the streaming HTTP client (default: `120s`).

## Container build process configuration

`wave.build.timeout` *(optional)*
: Sets the timeout for the build process (default: `5m`).

`wave.build.workspace` *(required)*
: Sets the path to the directory used by Wave to store artifacts such as Dockerfiles, Trivy cache for scan, Buildkit context, and authentication configuration files.
: For example, `/efs/wave/build`.

`wave.build.cleanup` *(optional)*
: Sets the cleanup strategy after the build process.
: Set to `OnSuccess` for cleanup only if a build is successful.

`wave.build.buildkit-image` *(optional)*
: Sets the specifies the [Buildkit](https://github.com/moby/buildkit) Docker image used in the Wave build process (default: `moby/buildkit:v0.13.2-rootless`).

`wave.build.singularity-image` *(optional)*
: Sets the [Singularity](https://quay.io/repository/singularity/singularity?tab=tags) image used in the build process (default: `quay.io/singularity/singularity:v3.11.4-slim`.

`wave.build.singularity-image-arm64` *(optional)*
: Sets he ARM64 version of the Singularity image for the build process. (default: `quay.io/singularity/singularity:v3.11.4-slim-arm64`).

`wave.build.repo` *(required)*
: Specifies the Docker container repository for the Docker images built by Wave.

`wave.build.cache` *(required)*
: Determines the Docker container repository used to cache layers of images built by Wave.

`wave.build.status.delay` *(optional)*
: Sets the delay between build status checks. (default: `5s`).

`wave.build.status.duration`
: Sets the duration for build status checks. (default: `1d`).

`wave.build.public` *(optional)*
: Specifies whether the Docker container repository is public.
: If set to `true`, Wave freeze will prefer this public repository over `wave.build.repo`.`

`wave.build.oci-mediatypes` *(optional)*
: Sets whether to use OCI media types in exported manifests (default: `true`).

`wave.build.compression` *(optional)*
: Sets which type of compression will be applied to cache layers (default: `gzip`).
: Options include: `uncompressed|estargz|zstd`.

`wave.build.force-compression` *(optional)*
: Specifies whether to force the compression for each cache layers produced by the build process (default: `false`).

### Build process logs configuration

This configuration specifies attributes for the persistence of the logs fetched from containers or k8s pods used for building requested images, which can be accessed later and also attached to the build completion email.

`wave.build.logs.bucket` *(required)*
: Sets the AWS S3 bucket where Wave will store build process logs.

`wave.build.logs.path` *(required)*
: Sets the path inside  `wave.build.logs.bucket` where Wave will store build logs.

`wave.build.locks.path` *(required)*
: Sets the path inside `wave.build.logs.bucket` where Wave will store conda lock files.

`wave.build.logs.prefix` *(optional)*
: Sets the prefix for build process log files in the specified S3 bucket.

`wave.build.logs.maxLength` *(optional)*
: Determines the maximum number of bytes that can be read from a log file. If a log file exceeds this limit, it will be truncated. (default: `100000` (100 KB)).

### Kubernetes configuration for container build process

Kubernetes configuration has options specific for k8s, and most of them, except CPU and memory, are the same for the build and scan process.

:::note
These settings apply only when running on Kubernetes.
:::

`wave.build.k8s.namespace` *(required)*
: Sets the Kubernetes namespace where Wave will run its build pods.

`wave.build.k8s.storage.claimName` *(optional)*
: Sets the volume claim name for the Wave build Kubernetes pods.

`wave.build.k8s.storage.mountPath` *(optional)*
: Sets the volume mount path on Wave build Kubernetes pods.

`wave.build.k8s.labels` *(optional)*
: allows you to set labels on Wave build Kubernetes pods.

`wave.build.k8s.node-selector` *(optional)*
: Sets the node selector for Wave build Kubernetes pods.

`wave.build.k8s.service-account` *(optional)*
: Specifies the Kubernetes service account name to be used by Wave build pods.

`wave.build.k8s.resources.requests.cpu` *(optional)*
: Sets the [CPU resources](https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#resource-units-in-kubernetes) to allocate to Wave build processes.
: For example, `2` or `1500Mi` (1.5 CPU cores).

`wave.build.k8s.resources.requests.memory` *(optional)*
: Sets the [memory resources](https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#resource-units-in-kubernetes) to allocate to Wave build processes.
: For example, it could be set to `3Gi` (3 Megabytes) or `2000Mi` (2000 Megabytes).

## Container scan process configuration

Scan process configuration lets the user provide a [Trivy docker image](https://hub.docker.com/r/aquasec/trivy) with any tag and severity levels of vulnerability that need to be scanned.

`wave.scan.enabled` *(optional)*
: Specifies whether vulnerability scanning is enabled or disabled (default: `false`).

`wave.scan.severity` *(optional)*
: Sets the [severity levels](https://aquasecurity.github.io/trivy/v0.22.0/vulnerability/examples/filter/) to report in vulnerability scanning.
: Options include: `MEDIUM,HIGH,CRITICAL`.

`wave.scan.image.name`  *(optional)*
: Sets the [Trivy docker image](https://hub.docker.com/r/aquasec/trivy) to use for container security scanning (default: `aquasec/trivy:0.47.0`).

### Kubernetes configuration for Wave scan process

Wave scan process uses the same k8s configuration of the build process except for CPU and memory requirements for the k8s pod.

:::note
These settings apply only when using Kubernetes.
:::

`wave.scan.k8s.resources.requests.cpu`
: Sets the amount of [CPU resources](https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#resource-units-in-kubernetes) allocated to Wave scan processes. For instance, you can set it to `2` or `1500Mi` (1.5 CPU cores). *(optional)*

`wave.scan.k8s.resources.requests.memory`
: Sets the [memory resources](https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#resource-units-in-kubernetes) allocated to Wave scan processes. For example, it could be set to `3Gi` or `2000Mi` (3 or 2000 Megabytes). *(optional)*

## Rate limit configuration

Rate limit configuration controls the limits of anonymous and authenticated users' access to Wave.

:::note
Change these properties to tweak rate limits in Wave.
:::

`rate-limit.build.anonymous`
: Sets the rate limit for anonymous build requests. By default, it allows up to 25 build requests per hour (`25/1d`) from anonymous users. This setting controls the frequency at which anonymous users can trigger build processes in Wave. *(required)*

`rate-limit.build.authenticated`
: Sets the rate limit for authenticated build requests. By default, it allows up to 100 build requests per hour (`100/1h`) from authenticated users. This setting governs the rate at which authenticated users can initiate build processes in Wave. *(required)*

`rate-limit.pull.anonymous`
: Sets the rate limit for anonymous pull requests. It is set to allow up to 250 pull requests per hour (`250/1h`) from anonymous users by default. This setting controls how frequently anonymous users can perform pull operations in Wave. *(required)*

`rate-limit.pull.authenticated`
: Sets the rate limit for authenticated pull requests. By default, it allows up to 2k pull requests per minute (`2000/1m`) from authenticated users. This setting governs the rate at which authenticated users can perform pull operations in Wave. *(required)*

`wave.denyPaths`
: user to filter out API calls for specific artifacts like manifests, which doesn't exist. *(optional)*

## Database and cache configuration

### Redis configuration

`redis.uri`
: Sets the Uniform Resource Identifier (URI) for connecting to Redis, a popular in-memory data store. By default, it uses the format `redis://${REDIS_HOST:redis}:${REDIS_PORT:6379}`, allowing customization of the Redis host and port through environment variables. *(required)*

`redis.pool.enabled`
: Whether to enable the Redis pool. It is set to `true` by default, enabling the use of a connection pool for efficient management of connections to the Redis server. *(optional)*

`redis.pool.minIdle`
: Specifies the minimum number of idle connections to maintain in the Redis connection pool. The default value is `0`. This ensures that connections are readily available for use.  *(optional)*

`redis.pool.maxIdle`
: Specifies the maximum number of idle connections to maintain in the Redis connection pool. The default value is `10`.  *(optional)*

`redis.pool.maxTotal`
: Specifies the maximum number of connections that can be maintained in the Redis connection pool. The default value is `50`. This helps to manage resource usage efficiently while supporting high demand.  *(optional)*

`redis.client.timeout`
: Sets the timeout duration (in milliseconds) for Redis client operations. The default value is `5000` (5 seconds).  *(optional)*

`redis.password`
: Specifies the password used to authenticate with the Redis server. This is needed when redis authentication is enabled.  *(optional)*

### SurrealDB configuration

`surreal.default.ns`
: Sets the namespace for the Surreal database. It can be set using `${SURREALDB_NS}` environment variable. *(required)*

`surreal.default.db`
: Sets the name of the Surreal database. It can be set using`${SURREALDB_DB}` environment variable. This setting defines the target database within the Surreal database system that Wave should interact with. *(required)*

`surreal.default.url`
: Sets the URL for connecting to the Surreal database. It can be set using `${SURREALDB_URL}` environment variable. This URL defines the endpoint that Wave uses to establish a connection with the Surreal database. *(required)*

`surreal.default.user`
: Sets the username used for authentication when connecting to the Surreal database. It can be set using `${SURREALDB_USER}` environment variable. *(required)*

`surreal.default.password`
: Sets the password used for authentication when connecting to the Surreal database. It can be set using `${SURREALDB_PASSWORD}` environment variable. *(required)*

`surreal.default.init-db`
: Whether to create database tables, records and indices at application startup  and `db`. *(optional)*

### PostgreSQL configuration

`wave.db.uri`
: JDBC connection string for the PostgreSQL database. For example, `jdbc:postgresql://localhost:5432/wave`. It can be set using `${WAVE_DB_URI}` environment variable.  *(required)*

`wave.db.user`
: Username for authenticating with the PostgreSQL database. It can be set using `${WAVE_DB_USER}` environment variable. *(required)*

`wave.db.password`
: Password for the PostgreSQL database user. It can be set using `${WAVE_DB_PASSWORD}` environment variable. *(required)*

## Blob Cache configuration

Wave offers a feature to provide a cache for Docker blobs, which improves the performance of supplying blobs to the client. If you use Kubernetes, Wave can also use the k8s pod to delegate the transfer task for scalability.

`wave.blobCache.enabled`
: Whether to enable the blob cache. It is `false` by default. *(optional)*

`wave.blobCache.s5cmdImage`
: Sets the Docker image that supplies the [s5cmd tool](https://github.com/peak/s5cmd). This tool is used to upload blob binaries to the S3 bucket. The default image used by Wave is `public.cr.seqera.io/wave/s5cmd:v2.2.2`. *(optional)*

`wave.blobCache.status.delay`
: Sets the time delay in checking the status of the transfer of the blob binary from the repository to the cache. Its default value is `5s`. *(optional)*

`wave.blobCache.status.duration`
: Sets the time for which Wave will store the blob binary in cache. Its default value is `5d`. *(optional)*

`wave.blobCache.timeout`
: Timeout for blob binary transfer, after which Wave will throw a `TransferTimeoutException` exception. Its default value is `5m`. *(optional)*

`wave.blobCache.baseUrl`
: Sets the URL, which will override the base URL (part of URL before the blob path) of blobs sent to the end client. *(optional)*

`wave.blobCache.signing-strategy`
: Sets the URL signing strategy for different services. Currently, Wave offers it for AWS S3 and Cloudflare and you can use the respective values to enable them `aws-presigned-url` and `cloudflare-waf-token`. *(required)*

`wave.blobCache.cloudflare.lifetime`
: Sets the validity of the cloud flare WAF token. *(required)*

`wave.blobCache.cloudflare.urlSignatureDuration`
: Sets the validity of the AWS S3 URL signature. Its default value is `30m`. *(optional)*

`wave.blobCache.cloudflare.secret-key`
: Sets the [Cloudflare secret](https://developers.cloudflare.com/waf/custom-rules/use-cases/configure-token-authentication/) to create the WAF token. *(required)*

`wave.blobCache.storage.bucket`
: Sets the name of Cloudflare or S3 bucket. For example, `s3://wave-blob-cache`. *(required)*

`wave.blobCache.storage.region`
: Sets the AWS region where the bucket is created. *(required)*

`wave.blobCache.storage.endpoint`
: Sets the URL for the storage location. This will be used for the download or upload of blob binaries. *(optional)*

`wave.blobCache.storage.accessKey`
: Sets the access key (part of credentials) to access the resources of the service used for caching. *(optional)*

`wave.blobCache.storage.secretKey`
: Sets the secret key (part of credentials) to access the resources of the service used for caching. *(optional)*

`wave.blobCache.requestsCpu`
: Sets the amount of [CPU resources](https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#resource-units-in-kubernetes) allocated to the k8s pod used for blob binary transfers. *(optional)*

`wave.blobCache.requestsMemory`
: Sets the [memory resources](https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#resource-units-in-kubernetes) allocated to the k8s pod used for blob binary transfers. *(optional)*

## Email configuration

Email ID to send emails from on the behalf of the Wave service.

`mail.from`
: Specifies the sender's email address for Wave notifications. This email address serves as the point of origin for any emails sent by Wave, providing a recognizable source for notifications. This setting is crucial for configuring the sender identity when Wave sends email notifications.  *(required)*

## Metrics configuration

Wave Metrics service provides data about container builds and pulls per ip, container image, and user.

`wave.metrics.enabled`
: Whether to enable the Wave metrics. It is `false` by default. *(optional)*

## Accounts configuration

`wave.accounts`
: Specifies a list of credentials to access authenticated Wave APIs like metrics APIs. *(required)*

Format of the credential list:

```console
- <USERNAME>:<PASSWORD_CHECKSUM>
```

